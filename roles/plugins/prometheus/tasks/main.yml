---
# tasks file for prometheus
- name: Download package
  get_url:
    url: "https://github.com/prometheus/prometheus/releases/download/v{{ PROMETHEUS_VERSION }}/prometheus-{{ PROMETHEUS_VERSION }}.linux-amd64.tar.gz"
    dest: "/usr/local/src/prometheus-{{ PROMETHEUS_VERSION }}.linux-amd64.tar.gz"
    force: true
    mode: 0755
    owner: root
    group: root
    timeout: 3

- name: Extract package
  ansible.builtin.unarchive:
    src: "/usr/local/src/prometheus-{{ PROMETHEUS_VERSION }}.linux-amd64.tar.gz"
    dest: /usr/local/prometheus
    remote_src: yes
    extra_opts:
      - --strip-components=1
    owner: root
    group: root
    mode: 0755